# Skill Agent Tree - è‡ªä¸»æ™ºèƒ½ä½“æ ‘ç³»ç»Ÿ

ä¸€ä¸ªåŸºäº AgentScope çš„**å®Œå…¨è‡ªä¸»**çš„å±‚çº§å¤šæ™ºèƒ½ä½“ç³»ç»Ÿï¼Œç”¨äºæŠ€èƒ½å­¦ä¹ å’ŒçŸ¥è¯†ç§¯ç´¯ã€‚

## ğŸŒŸ æ ¸å¿ƒç‰¹æ€§

### 1. å®Œå…¨è‡ªä¸»å†³ç­–
- **æ™ºèƒ½ä½“è‡ªå·±å†³å®š**æ˜¯å¦åˆ›å»ºå­agentæˆ–å§”æ‰˜ä»»åŠ¡
- é€šè¿‡ **system prompt å¼•å¯¼** æ™ºèƒ½ä½“çš„å†³ç­–è¡Œä¸º
- ä½¿ç”¨ **å·¥å…·è°ƒç”¨** å®ç°æ™ºèƒ½ä½“çš„è‡ªä¸»è¡Œä¸º

### 2. é›¶æ£€ç´¢è®¾è®¡
- **ä¸ä¾èµ–ä»»ä½•æ£€ç´¢æŠ€æœ¯**ï¼ˆRAGã€å‘é‡æ•°æ®åº“ç­‰ï¼‰
- å®Œå…¨é€šè¿‡ **æ™ºèƒ½ä½“é—´é€šä¿¡** è§£å†³é—®é¢˜
- çˆ¶agentçŸ¥é“å­agentçš„èƒ½åŠ›ï¼ŒåŸºäºæ­¤åˆ†é…ä»»åŠ¡

### 3. åŒè®°å¿†ç³»ç»Ÿ
æ¯ä¸ªæ™ºèƒ½ä½“å…·å¤‡ä¸¤å¤§ç±»è®°å¿†ï¼š

#### ğŸ“š çŸ¥è¯†è®°å¿†ï¼ˆKnowledge Memoryï¼‰
- å­˜å‚¨é¢†åŸŸç›¸å…³çš„**çŸ¥è¯†ç‚¹**
- ä¾‹å¦‚ï¼šæ•°å­¦ä¸“å®¶è®°ä½æ•°å­¦å…¬å¼ã€å®šç†
- æŒ‰ä¸»é¢˜ç»„ç»‡ï¼Œæ”¯æŒæŸ¥è¯¢

#### ğŸ¯ æŠ€èƒ½è®°å¿†ï¼ˆSkill Memoryï¼‰
- å­˜å‚¨**æŠ€èƒ½çš„æŠ½è±¡æè¿°**
- è®°å½•**æ‰§è¡ŒæŠ€èƒ½çš„æ–¹æ³•è®º**
- ä¿å­˜**æˆåŠŸç¤ºä¾‹**
- æ”¯æŒæŠ€èƒ½å¤ç”¨

### 4. å±‚çº§ç»“æ„
- æ ‘å½¢ç»„ç»‡ç»“æ„
- çˆ¶å­å…³ç³»è®°å¿†
- å­agentä¹Ÿå¯ä»¥åˆ›å»ºè‡ªå·±çš„å­agent
- å½¢æˆä¸“ä¸šåŒ–çš„å±‚çº§ä½“ç³»

## ğŸ—ï¸ æ¶æ„è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      RootAgent                          â”‚
â”‚  - é€šç”¨åè°ƒèƒ½åŠ›                                         â”‚
â”‚  - è‡ªä¸»å†³ç­–åˆ›å»ºå­agent                                  â”‚
â”‚  - åŸºäºèƒ½åŠ›åˆ†é…ä»»åŠ¡                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
      â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
      â”‚             â”‚
      â–¼             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ MathAgentâ”‚  â”‚WriteAgentâ”‚
â”‚ æ•°å­¦ä¸“å®¶  â”‚  â”‚ å†™ä½œä¸“å®¶  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ PoetAgentâ”‚
              â”‚ è¯—æ­Œä¸“å®¶  â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ› ï¸ å¯ç”¨å·¥å…·

æ¯ä¸ªæ™ºèƒ½ä½“éƒ½é…å¤‡ä»¥ä¸‹å·¥å…·ï¼Œ**ç”±æ™ºèƒ½ä½“è‡ªä¸»å†³å®šä½•æ—¶ä½¿ç”¨**ï¼š

### ç®¡ç†å·¥å…·
- `create_child_agent` - åˆ›å»ºä¸“é—¨çš„å­æ™ºèƒ½ä½“
- `delegate_to_child` - å§”æ‰˜ä»»åŠ¡ç»™å­æ™ºèƒ½ä½“
- `list_my_children` - åˆ—å‡ºæ‰€æœ‰å­æ™ºèƒ½ä½“

### å­¦ä¹ å·¥å…·
- `learn_skill` - å­¦ä¹ å¹¶è®°å½•æ–°æŠ€èƒ½
- `remember_knowledge` - è®°ä½é¢†åŸŸçŸ¥è¯†

### æŸ¥è¯¢å·¥å…·
- `query_my_skills` - æŸ¥è¯¢å·²æŒæ¡çš„æŠ€èƒ½
- `query_my_knowledge` - æŸ¥è¯¢ç§¯ç´¯çš„çŸ¥è¯†

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å®‰è£…

```bash
cd skill_agent_tree
pip install -r requirements.txt
```

### é…ç½®

```bash
export DASHSCOPE_API_KEY="your-api-key"
```

### è¿è¡Œ

```bash
# äº¤äº’å¼ä¼šè¯
python main.py

# æŸ¥çœ‹ç¤ºä¾‹
python examples_new.py
```

## ğŸ’¡ ä½¿ç”¨ç¤ºä¾‹

### ç¤ºä¾‹ 1: åˆ›å»ºè‡ªä¸»æ™ºèƒ½ä½“

```python
import agentscope
from tree_node_agent import TreeNodeAgent
from agentscope.model import DashScopeChatModel
from agentscope.formatter import DashScopeChatFormatter
from agentscope.tool import Toolkit
from agentscope.memory import InMemoryMemory

agentscope.init(project="MyProject", name="session")

agent = TreeNodeAgent(
    name="RootAgent",
    sys_prompt="""ä½ æ˜¯ä¸€ä¸ªè‡ªä¸»æ™ºèƒ½ä½“ã€‚

å½“æ”¶åˆ°ä»»åŠ¡æ—¶ï¼Œä½ åº”è¯¥ï¼š
1. æ€è€ƒä»»åŠ¡ç±»å‹
2. åˆ¤æ–­æ˜¯å¦éœ€è¦å­æ™ºèƒ½ä½“
3. ä½¿ç”¨å·¥å…·ï¼ˆcreate_child_agent, delegate_to_childç­‰ï¼‰
4. å®Œæˆä»»åŠ¡åå­¦ä¹ ï¼ˆlearn_skill, remember_knowledgeï¼‰

è‡ªä¸»å†³ç­–ï¼""",
    model=DashScopeChatModel(model_name="qwen-max", api_key="xxx"),
    formatter=DashScopeChatFormatter(),
    toolkit=Toolkit(),
    memory=InMemoryMemory(),
    skill_domain="é€šç”¨"
)
```

### ç¤ºä¾‹ 2: æ™ºèƒ½ä½“è‡ªä¸»å·¥ä½œ

```python
from agentscope.message import Msg

# ç”¨æˆ·è¯·æ±‚
msg = Msg(name="user", content="å¸®æˆ‘è§£æ•°å­¦é¢˜", role="user")

# æ™ºèƒ½ä½“è‡ªä¸»å¤„ç†ï¼š
# 1. åˆ†æï¼šè¿™æ˜¯æ•°å­¦ä»»åŠ¡
# 2. åˆ¤æ–­ï¼šæˆ‘éœ€è¦æ•°å­¦ä¸“å®¶
# 3. å†³ç­–ï¼šåˆ›å»º MathAgent
# 4. å§”æ‰˜ï¼šå°†ä»»åŠ¡å‘ç»™ MathAgent
# 5. å­¦ä¹ ï¼šè®°å½•"æ•°å­¦"é¢†åŸŸçš„çŸ¥è¯†
response = await agent.reply(msg)

print(response.get_text_content())
```

### ç¤ºä¾‹ 3: æŸ¥çœ‹å­¦ä¹ æˆæœ

```python
# æŸ¥çœ‹æ™ºèƒ½ä½“ä¿¡æ¯
info = agent.get_agent_info()
print(f"å­æ™ºèƒ½ä½“: {info['children']}")
print(f"å·²å­¦æŠ€èƒ½: {info['skills']}")
print(f"çŸ¥è¯†ä¸»é¢˜: {info['knowledge_topics']}")

# æŸ¥çœ‹æŠ€èƒ½è¯¦æƒ…
print(agent.skill_memory.get_skills_summary())

# æŸ¥çœ‹çŸ¥è¯†è¯¦æƒ…
print(agent.knowledge_memory.get_knowledge_summary())
```

## ğŸ¯ å·¥ä½œåŸç†

### å†³ç­–æµç¨‹

```
ç”¨æˆ·è¯·æ±‚
    â†“
æ™ºèƒ½ä½“åˆ†æä»»åŠ¡
    â†“
æŸ¥è¯¢è‡ªèº«çŠ¶æ€ (query_my_skills, list_my_children)
    â†“
    â”œâ”€ æœ‰ç›¸å…³æŠ€èƒ½ â”€â†’ è‡ªå·±å¤„ç†
    â”œâ”€ æœ‰åˆé€‚å­agent â”€â†’ delegate_to_child
    â”œâ”€ éœ€è¦æ–°çš„å­agent â”€â†’ create_child_agent + delegate_to_child
    â””â”€ ç®€å•ä»»åŠ¡ â”€â†’ ç›´æ¥å›ç­”
    â†“
å®Œæˆä»»åŠ¡
    â†“
å­¦ä¹ æ€»ç»“ (learn_skill, remember_knowledge)
    â†“
è¿”å›å“åº”
```

### è®°å¿†ç®¡ç†

#### æŠ€èƒ½è®°å¿†ï¼ˆSkill Memoryï¼‰

```python
# æ™ºèƒ½ä½“è‡ªåŠ¨è°ƒç”¨
agent.skill_memory.add_skill(
    skill_name="æ–¹ç¨‹æ±‚è§£",
    description="æ±‚è§£ä¸€å…ƒäºŒæ¬¡æ–¹ç¨‹",
    methodology="1. è¯†åˆ«æ–¹ç¨‹ç±»å‹ 2. åº”ç”¨æ±‚æ ¹å…¬å¼ 3. éªŒè¯ç»“æœ",
    examples=["x^2+2x+1=0", "2x^2-3x+1=0"]
)

# æŸ¥è¯¢æŠ€èƒ½
skill = agent.skill_memory.get_skill("æ–¹ç¨‹æ±‚è§£")
print(skill['methodology'])  # è·å–æ–¹æ³•è®º
print(skill['examples'])      # è·å–ç¤ºä¾‹
```

#### çŸ¥è¯†è®°å¿†ï¼ˆKnowledge Memoryï¼‰

```python
# æ™ºèƒ½ä½“è‡ªåŠ¨è°ƒç”¨
agent.knowledge_memory.add_knowledge(
    topic="æ•°å­¦",
    knowledge_point="ä¸€å…ƒäºŒæ¬¡æ–¹ç¨‹æ±‚æ ¹å…¬å¼ï¼šx = [-b Â± âˆš(bÂ²-4ac)] / 2a"
)

# æŸ¥è¯¢çŸ¥è¯†
knowledge = agent.knowledge_memory.get_knowledge("æ•°å­¦")
for fact in knowledge:
    print(fact)
```

## ğŸ”§ System Prompt è®¾è®¡

å…³é”®åœ¨äºé€šè¿‡ system prompt **å¼•å¯¼æ™ºèƒ½ä½“è‡ªä¸»å†³ç­–**ï¼š

```python
sys_prompt = """ä½ æ˜¯ä¸€ä¸ªè‡ªä¸»æ™ºèƒ½ä½“ã€‚

## ä½ çš„å·¥ä½œæµç¨‹

1. **åˆ†æä»»åŠ¡**
   - è¿™æ˜¯ä»€ä¹ˆç±»å‹çš„ä»»åŠ¡ï¼Ÿ
   - æˆ‘ä»¥å‰å¤„ç†è¿‡å—ï¼Ÿ

2. **æŸ¥è¯¢ç°çŠ¶**ï¼ˆä½¿ç”¨å·¥å…·ï¼‰
   - query_my_skills: æˆ‘æŒæ¡ç›¸å…³æŠ€èƒ½å—ï¼Ÿ
   - list_my_children: æˆ‘æœ‰å¯ä»¥å§”æ‰˜çš„å­æ™ºèƒ½ä½“å—ï¼Ÿ

3. **åšå‡ºå†³ç­–**
   - å¦‚æœæœ‰æŠ€èƒ½ï¼šç›´æ¥ä½¿ç”¨
   - å¦‚æœæœ‰å­agentï¼šä½¿ç”¨ delegate_to_child
   - å¦‚æœéœ€è¦æ–°å­agentï¼šä½¿ç”¨ create_child_agent

4. **æ‰§è¡Œä»»åŠ¡**

5. **å­¦ä¹ æ€»ç»“**
   - ä½¿ç”¨ learn_skill è®°å½•æŠ€èƒ½
   - ä½¿ç”¨ remember_knowledge è®°ä½çŸ¥è¯†

**é‡è¦**: ä½ è¦è‡ªå·±æ€è€ƒå¹¶å†³ç­–ï¼Œä¸»åŠ¨ä½¿ç”¨å·¥å…·ï¼
"""
```

## ğŸ“Š ç‰¹æ€§å¯¹æ¯”

| ç‰¹æ€§ | ä¼ ç»Ÿå¤šæ™ºèƒ½ä½“ç³»ç»Ÿ | Skill Agent Tree |
|------|----------------|------------------|
| ä»»åŠ¡åˆ†é… | å¤–éƒ¨æ§åˆ¶ | æ™ºèƒ½ä½“è‡ªä¸»å†³ç­– |
| å­agentåˆ›å»º | é¢„å®šä¹‰ | åŠ¨æ€æŒ‰éœ€åˆ›å»º |
| çŸ¥è¯†ç®¡ç† | RAGæ£€ç´¢ | æ™ºèƒ½ä½“è®°å¿† |
| é€šä¿¡æ–¹å¼ | æ¶ˆæ¯é˜Ÿåˆ— | ç›´æ¥é€šä¿¡ |
| æŠ€èƒ½å­¦ä¹  | ä¸æ”¯æŒ | è‡ªåŠ¨ç§¯ç´¯ |
| å±‚çº§ç»“æ„ | é™æ€ | åŠ¨æ€ç”Ÿé•¿ |

## ğŸ“ æ ¸å¿ƒæ¦‚å¿µ

### 1. è‡ªä¸»å†³ç­–
- æ™ºèƒ½ä½“**ä¸æ˜¯è¢«åŠ¨æ‰§è¡ŒæŒ‡ä»¤**
- è€Œæ˜¯**ä¸»åŠ¨æ€è€ƒã€åˆ¤æ–­ã€å†³ç­–**
- é€šè¿‡ system prompt å¼•å¯¼æ€è€ƒæ–¹å‘

### 2. å·¥å…·é©±åŠ¨
- åˆ›å»ºå­agentæ˜¯**å·¥å…·è°ƒç”¨**
- å§”æ‰˜ä»»åŠ¡æ˜¯**å·¥å…·è°ƒç”¨**
- å­¦ä¹ æŠ€èƒ½æ˜¯**å·¥å…·è°ƒç”¨**
- ä¸€åˆ‡éƒ½ç”±æ™ºèƒ½ä½“è‡ªå·±å†³å®š

### 3. é€šä¿¡è€Œéæ£€ç´¢
- ä¸ä½¿ç”¨å‘é‡æ•°æ®åº“
- ä¸ä½¿ç”¨RAG
- çˆ¶agent**çŸ¥é“**å­agentçš„èƒ½åŠ›
- åŸºäºèƒ½åŠ›è¿›è¡Œ**ç›´æ¥é€šä¿¡**

### 4. è®°å¿†å³å­¦ä¹ 
- æ¯æ¬¡äº¤äº’éƒ½å¯èƒ½äº§ç”Ÿå­¦ä¹ 
- æŠ€èƒ½è®°å¿†ï¼šæŠ½è±¡çš„æ–¹æ³•è®º
- çŸ¥è¯†è®°å¿†ï¼šå…·ä½“çš„çŸ¥è¯†ç‚¹
- è®°å¿†æŒ‡å¯¼æœªæ¥è¡Œä¸º

## ğŸ” è°ƒè¯•å’Œç›‘æ§

### æŸ¥çœ‹æ™ºèƒ½ä½“çŠ¶æ€

```python
# è·å–å®Œæ•´ä¿¡æ¯
info = agent.get_agent_info()

# è·å–ä¸Šä¸‹æ–‡
context = agent.get_full_context()
print(context)
```

### æŸ¥çœ‹æ ‘ç»“æ„

```python
from agent_tree import AgentTree

tree = AgentTree("RootAgent")
tree.add_root_agent(agent, "RootAgent")

# åŒæ­¥ä»æ™ºèƒ½ä½“åˆ›å»ºçš„å­agent
tree.sync_from_agents()

# å¯è§†åŒ–
print(tree.print_tree())

# å¯¼å‡ºçŠ¶æ€
json_state = tree.export_tree_state()
```

## ğŸš§ å·²çŸ¥é™åˆ¶

1. **å¼‚æ­¥è°ƒç”¨é—®é¢˜**: å·¥å…·å‡½æ•°ä¸­è°ƒç”¨å­agentçš„å¼‚æ­¥æ–¹æ³•æœ‰ä¸€å®šé™åˆ¶
2. **è®°å¿†å®¹é‡**: å½“å‰ä¸ºå†…å­˜å­˜å‚¨ï¼Œé‡å¯åä¸¢å¤±
3. **å¹¶å‘å¤„ç†**: æš‚ä¸æ”¯æŒå¤šä»»åŠ¡å¹¶å‘

## ğŸ›£ï¸ æœªæ¥è®¡åˆ’

- [ ] æŒä¹…åŒ–è®°å¿†å­˜å‚¨
- [ ] æ”¯æŒå¤šç§LLMæä¾›å•†
- [ ] ä¼˜åŒ–å¼‚æ­¥å·¥å…·è°ƒç”¨
- [ ] æ·»åŠ è®°å¿†æ£€ç´¢ä¼˜åŒ–
- [ ] æ”¯æŒæŠ€èƒ½ç‰ˆæœ¬ç®¡ç†
- [ ] Webå¯è§†åŒ–ç•Œé¢
- [ ] åˆ†å¸ƒå¼éƒ¨ç½²æ”¯æŒ

## ğŸ“š æ–‡æ¡£

- `README_NEW.md` - æœ¬æ–‡ä»¶ï¼Œæ–°ç‰ˆè¯´æ˜
- `README.md` - æ—§ç‰ˆæ–‡æ¡£
- `QUICKSTART.md` - å¿«é€Ÿå¼€å§‹æŒ‡å—
- `SETUP.md` - è¯¦ç»†é…ç½®è¯´æ˜
- `IMPLEMENTATION.md` - å®ç°ç»†èŠ‚

## ğŸ¤ å¯¹æ¯”æ—§ç‰ˆ

### ä¸»è¦æ”¹è¿›

1. **è‡ªä¸»å†³ç­–**: æ—§ç‰ˆéœ€è¦å¤–éƒ¨è°ƒç”¨åˆ›å»ºå­agentï¼Œæ–°ç‰ˆç”±æ™ºèƒ½ä½“è‡ªå·±å†³å®š
2. **å·¥å…·åŒ–**: æ‰€æœ‰æ“ä½œéƒ½å˜æˆå·¥å…·ï¼Œæ™ºèƒ½ä½“é€šè¿‡å·¥å…·äº¤äº’
3. **åŒè®°å¿†**: æ–°å¢çŸ¥è¯†è®°å¿†å’ŒæŠ€èƒ½è®°å¿†ä¸¤å¤§ç³»ç»Ÿ
4. **é›¶æ£€ç´¢**: ç§»é™¤æ‰€æœ‰æ£€ç´¢æœºåˆ¶ï¼Œçº¯é€šä¿¡è®¾è®¡

### è¿ç§»æŒ‡å—

ä»æ—§ç‰ˆè¿ç§»ï¼š

```python
# æ—§ç‰ˆï¼ˆå¤–éƒ¨æ§åˆ¶ï¼‰
child = await root_agent.create_child_agent(...)
response = await root_agent.delegate_task(...)

# æ–°ç‰ˆï¼ˆæ™ºèƒ½ä½“è‡ªä¸»ï¼‰
# ä¸éœ€è¦å¤–éƒ¨è°ƒç”¨ï¼Œæ™ºèƒ½ä½“è‡ªå·±ä¼šä½¿ç”¨å·¥å…·ï¼š
# - create_child_agent å·¥å…·
# - delegate_to_child å·¥å…·
response = await root_agent.reply(msg)
```

## ğŸ“„ License

MIT License

## ğŸ™ è‡´è°¢

åŸºäº [AgentScope](https://github.com/modelscope/agentscope) æ¡†æ¶æ„å»ºã€‚

---

**ç‰ˆæœ¬**: 2.0  
**æœ€åæ›´æ–°**: 2024-11  
**ç»´æŠ¤è€…**: Skill Agent Tree Team
